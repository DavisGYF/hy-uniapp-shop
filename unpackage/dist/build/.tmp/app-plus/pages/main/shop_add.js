(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/main/shop_add"],{"154a":function(t,e,i){"use strict";i("7297");var a=n(i("b0ce")),s=n(i("7eb2"));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(s.default))},"31a8":function(t,e,i){"use strict";var a=i("e0ae"),s=i.n(a);s.a},"6f0d":function(t,e,i){"use strict";i.r(e);var a=i("fc54"),s=i.n(a);for(var n in a)"default"!==n&&function(t){i.d(e,t,function(){return a[t]})}(n);e["default"]=s.a},"7eb2":function(t,e,i){"use strict";i.r(e);var a=i("9bd1"),s=i("6f0d");for(var n in s)"default"!==n&&function(t){i.d(e,t,function(){return s[t]})}(n);i("31a8");var o=i("2877"),l=Object(o["a"])(s["default"],a["a"],a["b"],!1,null,"87b50f64",null);e["default"]=l.exports},"9bd1":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",[i("view",[i("van-steps",{attrs:{steps:t.steps,active:t.active,mpcomid:"8d52f9ce-0"}})],1),i("view",{staticClass:"uni-padding-wrap uni-common-mt",staticStyle:{opacity:"0",height:"1rpx"}},[i("uni-segmented-control",{attrs:{current:t.current,values:t.items,styleType:t.styleType,activeColor:t.activeColor,eventid:"8d52f9ce-0",mpcomid:"8d52f9ce-1"},on:{clickItem:t.onClickItem}})],1),i("view",{staticClass:"content"},[i("view",{directives:[{name:"show",rawName:"v-show",value:0===t.current,expression:"current === 0"}]},[i("map",{attrs:{latitude:t.latitude,longitude:t.longitude,markers:t.covers_markers,scale:"14","show-location":""}}),i("form",{attrs:{eventid:"8d52f9ce-9"},on:{submit:t.formSubmit,reset:t.formReset}},[i("view",{staticClass:"uni-list"},[i("view",{staticClass:"uni-list-cell "},[i("view",{staticClass:"uni-title"},[t._v("基本信息")])]),i("view",{staticClass:"uni-list-cell"},[t._v("联 系 人"),i("input",{directives:[{name:"model",rawName:"v-model",value:t.text_info.id_name,expression:"text_info.id_name"}],staticClass:"uni-input",attrs:{name:"name",placeholder:"请输入",eventid:"8d52f9ce-1"},domProps:{value:t.text_info.id_name},on:{input:function(e){e.target.composing||(t.text_info.id_name=e.target.value)}}})]),i("view",{staticClass:"uni-list-cell"},[t._v("店铺名称"),i("input",{directives:[{name:"model",rawName:"v-model",value:t.text_info.store_name,expression:"text_info.store_name"}],staticClass:"uni-input",attrs:{name:"store_name",placeholder:"请输入",eventid:"8d52f9ce-2"},domProps:{value:t.text_info.store_name},on:{input:function(e){e.target.composing||(t.text_info.store_name=e.target.value)}}})]),i("view",{staticClass:"uni-list-cell"},[t._v("联系电话"),i("input",{directives:[{name:"model",rawName:"v-model",value:t.text_info.store_tel,expression:"text_info.store_tel"}],staticClass:"uni-input",attrs:{name:"store_tel",placeholder:"请输入",eventid:"8d52f9ce-3"},domProps:{value:t.text_info.store_tel},on:{input:function(e){e.target.composing||(t.text_info.store_tel=e.target.value)}}})]),i("view",{staticClass:"uni-list-cell"},[t._v("营业状态"),i("view",{},[i("picker",{attrs:{value:t.array_index1,range:t.array1,eventid:"8d52f9ce-4"},on:{change:t.bindPickerChange1}},[i("view",{staticClass:"uni-input"},[t._v(t._s(t.array1[t.array_index1]))])])],1)]),i("view",{staticClass:"uni-list-cell"},[t._v("营业范围"),i("view",{staticClass:"uni-list-cell-right"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.text_info.label,expression:"text_info.label"}],staticClass:"uni-input",attrs:{name:"store_name",placeholder:"请输入",eventid:"8d52f9ce-5"},domProps:{value:t.text_info.label},on:{input:function(e){e.target.composing||(t.text_info.label=e.target.value)}}})])]),i("view",{staticClass:"uni-list-cell"},[t._v("所属行业"),i("view",{},[i("picker",{attrs:{value:t.array_index,range:t.array,eventid:"8d52f9ce-6"},on:{change:t.bindPickerChange}},[i("view",{staticClass:"uni-input"},[t._v(t._s(t.array[t.array_index]))])])],1)]),i("view",{staticClass:"uni-list-cell cell-pd"},[i("view",{staticClass:"uni-uploader"},[i("view",{staticClass:"uni-uploader-head"},[i("view",{staticClass:"uni-uploader-title"},[t._v("标示")])]),i("view",{staticClass:"uni-uploader-body"},[i("view",{staticClass:"uni-uploader__files"},[i("block",[i("view",{staticClass:"uni-uploader__file"},[i("image",{staticClass:"uni-uploader__img",attrs:{src:t.image2,"data-src":t.image2,eventid:"8d52f9ce-7"},on:{tap:function(e){t.previewImage(t.image,t.index)}}})])]),i("view",{staticClass:"uni-uploader__input-box"},[i("view",{staticClass:"uni-uploader__input",attrs:{eventid:"8d52f9ce-8"},on:{tap:t.chooseImage}})])],1)])])])])])],1),i("view",{directives:[{name:"show",rawName:"v-show",value:1===t.current,expression:"current === 1"}]},[i("form",{attrs:{eventid:"8d52f9ce-12"},on:{submit:t.formSubmit,reset:t.formReset}},[i("view",{staticClass:"uni-list"},[i("view",{staticClass:"uni-list-cell "},[i("view",{staticClass:"uni-title"},[t._v("店铺介绍")])]),i("view",{staticClass:"infoWarp"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text_info.info,expression:"text_info.info"}],staticStyle:{color:"#555"},attrs:{name:"info",placeholder:"请输入",eventid:"8d52f9ce-10"},domProps:{value:t.text_info.info},on:{input:function(e){e.target.composing||(t.text_info.info=e.target.value)}}})]),i("view",{staticClass:"mapWrap"},[i("view",{staticClass:"iconWrap",attrs:{eventid:"8d52f9ce-11"},on:{tap:t.choseLocation}},[i("uni-icon",{attrs:{type:"search",size:"30",mpcomid:"8d52f9ce-2"}}),i("input",{staticClass:"uni-input",attrs:{name:"store_name",disabled:"",placeholder:"搜索"}})],1),i("map",{attrs:{id:"myMap",latitude:t.latitude,longitude:t.longitude,markers:t.covers_markers,scale:"14","show-location":""}})],1)])])],1),i("view",{directives:[{name:"show",rawName:"v-show",value:2===t.current,expression:"current === 2"}]},[i("form",{attrs:{eventid:"8d52f9ce-18"},on:{submit:t.formSubmit,reset:t.formReset}},[i("view",{staticClass:"uni-list"},[i("view",{staticClass:"uni-list-cell "},[i("view",{staticClass:"uni-title"},[t._v("证件上传")])]),i("view",{staticClass:"uni-list-cell cell-pd"},[i("view",{staticClass:"uni-uploader"},[i("view",{staticClass:"uni-uploader-head"},[i("view",{staticClass:"uni-uploader-title"},[t._v("招牌照片")])]),i("view",{staticClass:"uni-uploader-body"},[i("view",{staticClass:"uni-uploader__files"},[i("block",[i("view",{staticClass:"uni-uploader__file",staticStyle:{width:"100%"}},[i("image",{staticClass:"uni-uploader__img",attrs:{src:t.image3,"data-src":t.image3,eventid:"8d52f9ce-13"},on:{tap:function(e){t.previewImage(t.image,t.index)}}})])])],1)])])]),i("view",{staticClass:"uni-list-cell cell-pd"},[i("view",{staticClass:"uni-uploader"},[i("view",{staticClass:"uni-uploader-head"},[i("view",{staticClass:"uni-uploader-title"},[t._v("营业执照")])]),i("view",{staticClass:"uni-uploader-body"},[i("view",{staticClass:"uni-uploader__files"},[t._l(t.imageList1,function(e,a){return i("block",{key:a},[i("view",{staticClass:"uni-uploader__file"},[i("image",{staticClass:"uni-uploader__img",attrs:{src:e,"data-src":e,eventid:"8d52f9ce-14-"+a},on:{tap:function(i){t.previewImage(e,a)}}})])])}),i("view",{staticClass:"uni-uploader__input-box"},[i("view",{staticClass:"uni-uploader__input",attrs:{eventid:"8d52f9ce-15"},on:{tap:t.chooseImage}})])],2)])])]),i("view",{staticClass:"uni-list-cell cell-pd"},[i("view",{staticClass:"uni-uploader"},[i("view",{staticClass:"uni-uploader-head"},[i("view",{staticClass:"uni-uploader-title"},[t._v("身份证正反面")])]),i("view",{staticClass:"uni-uploader-body"},[i("view",{staticClass:"uni-uploader__files"},[t._l(t.imageList1,function(e,a){return i("block",{key:a},[i("view",{staticClass:"uni-uploader__file"},[i("image",{staticClass:"uni-uploader__img",attrs:{src:e,"data-src":e,eventid:"8d52f9ce-16-"+a},on:{tap:function(i){t.previewImage(e,a)}}})])])}),i("view",{staticClass:"uni-uploader__input-box"},[i("view",{staticClass:"uni-uploader__input",attrs:{eventid:"8d52f9ce-17"},on:{tap:t.chooseImage}})])],2)])])])])])],1)]),i("view",{staticClass:"uni-btn-v"},[2==t.active?i("button",{staticClass:"btn-submit",attrs:{type:"primary",eventid:"8d52f9ce-19"},on:{tap:t.formSubmit}},[t._v("确认修改")]):t._e(),2!=t.active?i("button",{staticClass:"btn-submit",attrs:{type:"primary",eventid:"8d52f9ce-20"},on:{tap:t.nextStepsFn}},[t._v("下一步")]):t._e(),0!=t.active?i("button",{attrs:{type:"default",eventid:"8d52f9ce-21"},on:{tap:t.preStepsFn}},[t._v("上一步")]):t._e()],1)])},s=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return s})},e0ae:function(t,e,i){},fc54:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a,s=o(i("a34a")),n=o(i("7861"));function o(t){return t&&t.__esModule?t:{default:t}}function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function c(t,e,i,a,s,n,o){try{var l=t[n](o),c=l.value}catch(r){return void i(r)}l.done?e(c):Promise.resolve(c).then(a,s)}function r(t){return function(){var e=this,i=arguments;return new Promise(function(a,s){var n=t.apply(e,i);function o(t){c(n,a,s,o,l,"next",t)}function l(t){c(n,a,s,o,l,"throw",t)}o(void 0)})}}i("7389");var u={components:{uniSegmentedControl:n.default},data:function(){return{steps:[{text:"步骤一",desc:"基本信息"},{text:"步骤二",desc:"店铺介绍"},{text:"步骤三",desc:"证件上传"}],active:0,array:["餐饮美食","洗浴住宿","观影k哥"],array1:["正常营业","休息中","已关店"],array_index:0,array_index1:0,current:0,items:["步骤 1","步骤 2","步骤 3"],activeColor:"#0faeff",styleType:"button",image1:"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1548333482233&di=60b900e6a904442b001a7876b023bb9f&imgtype=0&src=http%3A%2F%2Fimage.biaobaiju.com%2Fuploads%2F20180211%2F01%2F1518282998-waBQxRPASr.jpg",image3:"https://img-cdn-qiniu.dcloud.net.cn/tuku/img/jianzhu03-l.jpg",image2:"http://img5.imgtn.bdimg.com/it/u=4242739171,2434290170&fm=26&gp=0.jpg",imageList:[],imageList1:["http://img5.imgtn.bdimg.com/it/u=4242739171,2434290170&fm=26&gp=0.jpg","http://life.southmoney.com/tuwen/UploadFiles_6871/201804/20180423165909445.jpg"],uploaddata:{},text_info:{},latitude:null,longitude:null,covers_markers:[],mapCtx:null}},onShow:function(){this.imageList=this.$store.state.img_list,this.image1=this.$store.state.img},onLoad:function(){this.getOssParam(),this.imageList=[],this.getLocation()},onNavigationBarButtonTap:function(e){t.navigateTo({url:"./shop_info_edit"})},methods:(a={getData:function(){var e=this;this.$util.ajax_uni({url:"merchants/index/show",data:{ff_openid:t.getStorageSync("user_id")},success:function(t){console.log("返回店铺信息res:",t),1==t.data.status?e.text_info=t.data.data.data:console.log("ceeee",JSON.stringify(t.data))},error:function(t){console.log("错误res:",t)}})},nextStepsFn:function(){console.log("active--",this.active,"current===",this.current),this.active<2&&(this.active+=1,this.current+=1)},preStepsFn:function(){console.log("active--",this.active,"current===",this.current),this.active>0&&(this.active-=1,this.current-=1)},bindPickerChange:function(t){console.log("picker发送选择改变，携带值为",t.target.value),this.index=t.target.value},onClickItem:function(t){this.current!==t&&(this.current=t)},chooseImage1:function(){var t=r(s.default.mark(function t(){return s.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),countChange:function(t){this.countIndex=t.target.value},chooseImage:function(){var e=r(s.default.mark(function e(i){var a,n,o=this;return s.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a=this,1!=i){e.next=5;break}t.chooseImage({count:1,success:function(t){o.image1=t.tempFilePaths[0],o.$store.commit("changeImg",t.tempFilePaths[0])}}),e.next=13;break;case 5:if(9!==this.imageList.length){e.next=12;break}return e.next=8,this.isFullImg();case 8:if(n=e.sent,console.log("是否继续?",n),n){e.next=12;break}return e.abrupt("return");case 12:t.chooseImage({count:9-this.imageList.length,success:function(e){o.imageList=o.imageList.concat(e.tempFilePaths),o.$store.commit("changeImgList",e.tempFilePaths),console.log("res?-=======",e);for(var i=e.tempFilePaths,s=0;s<i.length;s++){var n=new FormData,l=a.uploaddata.dir+String(i[s].lastModified)+"_"+a.randomString(6);n.append("key",l),n.append("policy",a.uploaddata.policy),n.append("OSSAccessKeyId",a.uploaddata.OSSAccessKeyId),n.append("success_action_status","203"),n.append("callback",a.uploaddata.callback),n.append("signature",a.uploaddata.signature),t.uploadFile({url:"https://ffomall.oss-cn-hangzhou.aliyuncs.com",filePath:i[s],name:"file",formData:{key:l,policy:a.uploaddata.policy,OSSAccessKeyId:a.uploaddata.OSSAccessKeyId,callback:a.uploaddata.callback,signature:a.uploaddata.signature},success:function(e){console.log("uploadImage success, res is:",e),t.showToast({title:"上传成功",icon:"success",duration:1e3})},fail:function(e){console.log("uploadImage fail",e),t.showModal({content:e.errMsg,showCancel:!1}),t.hideLoading()},complete:function(){console.log("complate")}})}}});case 13:case"end":return e.stop()}},e,this)}));function i(t){return e.apply(this,arguments)}return i}(),randomString:function(t,e){e=e||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var i="",a=0;a<t;a++){var s=Math.floor(Math.random()*e.length);i+=e.substring(s,s+1)}return i},getOssParam:function(){var e=this;t.request({url:this.base_url+"notify/alioss/getsign",method:"post",data:{sign:"3521257fc593c5d202474f6ac0c245ae"},success:function(t){console.log("res?-",t),1==t.data.status&&(e.uploaddata=t.data.data)},fail:function(){},complete:function(){}})},formReset:function(t){console.log("清空数据"),this.chosen=""},isFullImg:function(){var e=this;return new Promise(function(i){t.showModal({content:"已经有9张图片了,是否清空现有图片？",success:function(t){t.confirm?(e.imageList=[],i(!0)):i(!1)},fail:function(){i(!1)}})})},previewImage:function(e,i){console.log("ee",e,i),1==e?t.navigateTo({url:"./shop_img_detail?data="+this.image2}):t.navigateTo({url:"./shop_img_detail?data="+e})},choseLocation:function(){var e=this;console.log("位置名称：--------"),t.chooseLocation({success:function(t){console.log("位置名称："+t.name),console.log("详细地址："+t.address),console.log("纬度："+t.latitude),console.log("经度："+t.longitude),e.longitude=t.longitude,e.latitude=t.latitude,e.covers_markers.pop(),e.covers_markers.push({latitude:t.latitude,longitude:t.longitude,label:{content:t.name}})}})},getLocation:function(){var e=this;t.getLocation({type:"gcj02",success:function(t){console.log("当前位置的纬度："+t.latitude),e.longitude=t.longitude,e.latitude=t.latitude,e.covers_markers.push({latitude:t.latitude,longitude:t.longitude})},fail:function(t){console.log("res-fail",t)}})}},l(a,"bindPickerChange",function(t){console.log("picker发送选择改变，携带值为",t.target.value),this.index=t.target.value}),l(a,"bindTimeChange",function(t){this.time=t.target.value}),l(a,"formSubmit",function(t){}),a)};e.default=u}).call(this,i("649d")["default"])}},[["154a","common/runtime","common/vendor"]]]);