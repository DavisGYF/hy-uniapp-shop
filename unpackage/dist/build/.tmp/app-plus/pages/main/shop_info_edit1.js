(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/main/shop_info_edit1"],{"00e4":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(a("a34a")),i=n(a("7861"));function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e,a,o,i,n,s){try{var l=t[n](s),c=l.value}catch(r){return void a(r)}l.done?e(c):Promise.resolve(c).then(o,i)}function l(t){return function(){var e=this,a=arguments;return new Promise(function(o,i){var n=t.apply(e,a);function l(t){s(n,o,i,l,c,"next",t)}function c(t){s(n,o,i,l,c,"throw",t)}l(void 0)})}}a("7389");var c={components:{uniSegmentedControl:i.default},data:function(){return{steps:[{text:"基本信息",desc:""},{text:"店铺介绍",desc:""},{text:"证件上传",desc:""}],active:0,current:0,items:["步骤 1","步骤 2","步骤 3"],storeListAll:[],storeList:[],cat_index:0,array:["餐饮美食","洗浴住宿","观影k哥"],array1:["正常营业","休息中","已关店"],array_index:0,activeColor:"#0faeff",styleType:"button",uploaddata:{},uploaddata_id:{},text_info:{},latitude:null,longitude:null,covers_markers:[],mapCtx:null,id_image_ist:[]}},onShow:function(){this.getData(),this.getOssParam()},onLoad:function(t){},methods:{getData:function(){var e=this;this.$util.ajax_uni({url:"merchants/index/show",data:{ff_openid:t.getStorageSync("user_id")},success:function(a){console.log("返回店铺信息res:",a),1==a.data.status?(e.text_info=a.data.data.data,e.getStore(),console.log("---------store onload===text_info",JSON.stringify(e.text_info)),void 0==e.text_info.profile_picture1?(console.log(0),e.id_image_ist=[e.text_info.profile_picture2]):void 0==e.text_info.profile_picture2?(console.log(1),e.id_image_ist=[e.text_info.profile_picture1]):(console.log(2),e.id_image_ist=[e.text_info.profile_picture1,e.text_info.profile_picture2]),console.log("id_image_ist===========",JSON.stringify(e.id_image_ist))):(console.log("ceeee",JSON.stringify(a.data)),t.showToast({icon:"none",title:a.data.msg}))},error:function(t){console.log("错误res:",t)}})},getStore:function(){var e=this;this.$util.ajax_uni({url:"merchants/index/cat",data:{},success:function(a){if(1==a.data.status)for(var o in e.storeListAll=a.data.data,a.data.data)a.data.data[o].value=a.data.data[o].id,e.storeList.push(a.data.data[o].name),a.data.data[o].id==e.text_info.cat_id&&(e.cat_index=o);else console.log("ceeee",JSON.stringify(a.data)),t.showToast({icon:"none",title:a.data.msg})},error:function(t){console.log("错误res:",t)}})},nextStepsFn:function(){console.log("active--",this.active,"current===",this.current),t.navigateTo({url:"shop_info_edit2"})},preStepsFn:function(){console.log("active--",this.active,"current===",this.current),this.active>0&&(this.active-=1,this.current-=1)},bindPickerChange1:function(t){console.log("picker发送选择改变，携带值为",t.target.value),this.text_info.store_status=t.target.value},catChange:function(t){console.log("picker发送选择改变，携带值为",t.target.value),this.cat_index=t.target.value,this.text_info.cat_id=this.storeListAll[t.target.value].id},onClickItem:function(t){this.current!==t&&(this.current=t)},previewImagFn:function(e,a){t.previewImage({urls:[e]})},previewImagFns:function(e,a,o){console.log("chooseImageFns----",e),1==o?t.previewImage({current:this.id_image_ist[a],urls:this.id_image_ist}):(this.$store.commit("changeShopEditInfo",this.text_info),t.navigateTo({url:"./shop_img_detail?data="+e+"&&flag="+a}))},chooseImageFn:function(){var e=l(o.default.mark(function e(a){var i;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:i=this,e.t0=a,e.next=1===e.t0?4:2===e.t0?6:3===e.t0?8:4===e.t0?10:11;break;case 4:return t.chooseImage({count:1,success:function(e){var a=e.tempFilePaths;console.log("res?-=======",JSON.stringify(e));var o=i.uploaddata.dir+Date.parse(new Date)+"_"+i.randomString(6)+"."+a[0].split(".").pop();t.uploadFile({url:"https://ffomall.oss-cn-hangzhou.aliyuncs.com",filePath:a[0],name:"file",formData:{key:o,policy:i.uploaddata.policy,OSSAccessKeyId:i.uploaddata.OSSAccessKeyId,callback:i.uploaddata.callback,signature:i.uploaddata.signature,success_action_status:"203"},success:function(t){console.log("uploadImage success, res is:",t.data),i.text_info.avatar="https://ffomall.oss-cn-hangzhou.aliyuncs.com/"+JSON.parse(t.data).filename},fail:function(e){console.log("uploadImage fail",JSON.stringify(e)),t.showModal({content:e.errMsg,showCancel:!1}),t.hideLoading()},complete:function(){console.log("complate")}})}}),e.abrupt("break",12);case 6:return t.chooseImage({count:1,success:function(e){var a=e.tempFilePaths;console.log("res?-=======",JSON.stringify(e));var o=i.uploaddata.dir+Date.parse(new Date)+"_"+i.randomString(6)+"."+a[0].split(".").pop();t.uploadFile({url:"https://ffomall.oss-cn-hangzhou.aliyuncs.com",filePath:a[0],name:"file",formData:{key:o,policy:i.uploaddata.policy,OSSAccessKeyId:i.uploaddata.OSSAccessKeyId,callback:i.uploaddata.callback,signature:i.uploaddata.signature,success_action_status:"203"},success:function(t){console.log("uploadImage success, res is:",t.data),i.text_info.store_img="https://ffomall.oss-cn-hangzhou.aliyuncs.com/"+JSON.parse(t.data).filename},fail:function(e){console.log("uploadImage fail",JSON.stringify(e)),t.showModal({content:e.errMsg,showCancel:!1}),t.hideLoading()},complete:function(){console.log("complate")}})}}),e.abrupt("break",12);case 8:return t.chooseImage({count:1,success:function(e){var a=e.tempFilePaths;console.log("res?-=======",JSON.stringify(e));var o=i.uploaddata.dir+Date.parse(new Date)+"_"+i.randomString(6)+"."+a[0].split(".").pop();t.uploadFile({url:"https://ffomall.oss-cn-hangzhou.aliyuncs.com",filePath:a[0],name:"file",formData:{key:o,policy:i.uploaddata.policy,OSSAccessKeyId:i.uploaddata.OSSAccessKeyId,callback:i.uploaddata.callback,signature:i.uploaddata.signature,success_action_status:"203"},success:function(t){console.log("uploadImage success------, res is:",t.data),i.text_info.store_img1="https://ffomall.oss-cn-hangzhou.aliyuncs.com/"+JSON.parse(t.data).filename,console.log("--修改",JSON.stringify(i.text_info))},fail:function(e){console.log("uploadImage fail",JSON.stringify(e)),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){console.log("complate")}})}}),e.abrupt("break",12);case 10:return e.abrupt("break",12);case 11:return e.abrupt("break",12);case 12:case"end":return e.stop()}},e,this)}));function a(t){return e.apply(this,arguments)}return a}(),chooseImageFns:function(e){var a=this;console.log("chooseImage--Fns----",e),2!=a.id_image_ist.length?t.chooseImage({count:2,success:function(e){var o=e.tempFilePaths;for(var i in console.log("res?-=======",JSON.stringify(e)),o){var n=a.uploaddata_id.dir+Date.parse(new Date)+"_"+a.randomString(6)+"."+o[i].split(".").pop();t.uploadFile({url:"https://ffomallcardid.oss-cn-hangzhou.aliyuncs.com",filePath:o[i],name:"file",formData:{key:n,policy:a.uploaddata_id.policy,OSSAccessKeyId:a.uploaddata_id.OSSAccessKeyId,callback:a.uploaddata_id.callback,signature:a.uploaddata_id.signature,success_action_status:"203"},success:function(t){a.id_image_ist.push("https://ffomallcardid.oss-cn-hangzhou.aliyuncs.com/"+JSON.parse(t.data).filename),console.log("uploadImage =====jiddddddd=:",JSON.stringify(a.id_image_ist))},fail:function(e){console.log("uploadImage fail",JSON.stringify(e)),t.showModal({content:e.errMsg,showCancel:!1}),t.hideLoading()},complete:function(){console.log("complate")}})}}}):t.showToast({title:"请先删除照片",icon:"none"})},randomString:function(t,e){e=e||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var a="",o=0;o<t;o++){var i=Math.floor(Math.random()*e.length);a+=e.substring(i,i+1)}return a},getOssParam:function(){var e=this;t.request({url:this.base_url+"notify/alioss/getsign",method:"post",data:{sign:"3521257fc593c5d202474f6ac0c245ae"},success:function(t){console.log("res?-",t),1==t.data.status&&(e.uploaddata=t.data.data)},fail:function(){},complete:function(){}})},getOssParamId:function(){var e=this;t.request({url:this.base_url+"merchants/index/upload",method:"post",data:{token:t.getStorageSync("token")},success:function(t){console.log("res?========-",t),1==t.data.status&&(e.uploaddata_id=t.data.data)},fail:function(){},complete:function(){}})},formReset:function(t){console.log("清空数据"),this.chosen=""},previewImageFn:function(e){t.previewImage({urls:[e]})},choseLocation:function(){var e=this;console.log("位置名称：--------"),t.chooseLocation({success:function(t){console.log("位置名称："+t.name),console.log("详细地址："+t.address),console.log("纬度："+t.latitude),console.log("经度："+t.longitude),e.longitude=t.longitude,e.latitude=t.latitude,e.covers_markers.pop(),e.covers_markers.push({latitude:t.latitude,longitude:t.longitude,label:{content:t.name}})}})},getLocation:function(){var e=this;t.getLocation({type:"gcj02",success:function(t){console.log("当前位置的纬度："+t.latitude),e.longitude=t.longitude,e.latitude=t.latitude,e.covers_markers.push({latitude:t.latitude,longitude:t.longitude})},fail:function(t){console.log("res-fail",t)}})},formSubmit:function(e){var a="";a=1==this.text_info.status?"merchants/index/updateRegistered":"merchants/index/updateReg",console.log("入参---修改",JSON.stringify(this.text_info)),this.$util.ajax_uni({url:a,data:this.text_info,success:function(e){console.log("修改--返回---es:",e),1==e.data.status?t.navigateTo({url:"./shop_info_edit2"}):(console.log("ceeee",JSON.stringify(e.data)),t.showToast({icon:"none",title:e.data.msg}))},error:function(t){console.log("错误res:",t)}})}}};e.default=c}).call(this,a("649d")["default"])},"3a94":function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"content"},[a("view",[a("van-steps",{attrs:{steps:t.steps,active:t.active,mpcomid:"6d461f1e-0"}})],1),a("view",[a("form",{attrs:{eventid:"6d461f1e-6"},on:{submit:t.formSubmit,reset:t.formReset}},[a("view",{staticClass:"uni-list"},[a("view",{staticClass:"uni-list-cell"},[a("view",{staticClass:"uni-title",staticStyle:{color:"#777"}},[t._v("基本信息")])]),a("view",{staticClass:"uni-list-cell"},[t._v("店铺名称"),a("view",{staticClass:"uni-list-cell-right"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.text_info.store_name,expression:"text_info.store_name"}],staticClass:"uni-input",attrs:{name:"store_name",placeholder:"请输入",eventid:"6d461f1e-0"},domProps:{value:t.text_info.store_name},on:{input:function(e){e.target.composing||(t.text_info.store_name=e.target.value)}}})])]),a("view",{staticClass:"uni-list-cell"},[t._v("联 系 人"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.text_info.id_name,expression:"text_info.id_name"}],staticClass:"uni-input",attrs:{name:"name",placeholder:"请输入",eventid:"6d461f1e-1"},domProps:{value:t.text_info.id_name},on:{input:function(e){e.target.composing||(t.text_info.id_name=e.target.value)}}})]),a("view",{staticClass:"uni-list-cell"},[t._v("联系电话"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.text_info.store_tel,expression:"text_info.store_tel"}],staticClass:"uni-input",attrs:{name:"store_tel",placeholder:"请输入",eventid:"6d461f1e-2"},domProps:{value:t.text_info.store_tel},on:{input:function(e){e.target.composing||(t.text_info.store_tel=e.target.value)}}})]),a("view",{staticClass:"uni-list-cell"},[t._v("所属行业"),a("view",{},[a("picker",{attrs:{value:t.cat_index,range:t.storeList,eventid:"6d461f1e-3"},on:{change:t.catChange}},[a("view",{staticClass:"uni-input"},[t._v(t._s(t.storeList[t.cat_index]))])])],1)]),a("view",{staticClass:"uni-list-cell cell-pd"},[a("view",{staticClass:"uni-uploader"},[a("view",{staticClass:"uni-uploader-head"},[a("view",{staticClass:"uni-uploader-title"},[t._v("店铺logo")])]),a("view",{staticClass:"uni-uploader-body"},[a("view",{staticClass:"uni-uploader__files"},[a("block",[a("view",{staticClass:"uni-uploader__file"},[a("image",{staticClass:"uni-uploader__img",attrs:{mode:"aspectFill",src:t.text_info.avatar,"data-src":t.text_info.avatar,eventid:"6d461f1e-4"},on:{tap:function(e){t.previewImagFn(t.text_info.avatar)}}})])]),a("view",{staticClass:"uni-uploader__input-box"},[a("view",{staticClass:"uni-uploader__input",attrs:{eventid:"6d461f1e-5"},on:{tap:function(e){t.chooseImageFn(1)}}})])],1)])])])])])],1),a("view",{staticClass:"uni-btn-v"},[a("button",{staticClass:"btn-submit",attrs:{type:"primary",eventid:"6d461f1e-7"},on:{tap:t.formSubmit}},[t._v("确认并下一步")])],1)])},i=[];a.d(e,"a",function(){return o}),a.d(e,"b",function(){return i})},"3d8e":function(t,e,a){"use strict";var o=a("868b"),i=a.n(o);i.a},"476e":function(t,e,a){"use strict";a.r(e);var o=a("3a94"),i=a("cb6b");for(var n in i)"default"!==n&&function(t){a.d(e,t,function(){return i[t]})}(n);a("3d8e");var s=a("2877"),l=Object(s["a"])(i["default"],o["a"],o["b"],!1,null,"40a123ff",null);e["default"]=l.exports},"868b":function(t,e,a){},cb6b:function(t,e,a){"use strict";a.r(e);var o=a("00e4"),i=a.n(o);for(var n in o)"default"!==n&&function(t){a.d(e,t,function(){return o[t]})}(n);e["default"]=i.a},fe64:function(t,e,a){"use strict";a("7297");var o=n(a("b0ce")),i=n(a("476e"));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,o.default)(i.default))}},[["fe64","common/runtime","common/vendor"]]]);