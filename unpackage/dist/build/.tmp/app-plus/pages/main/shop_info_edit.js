(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/main/shop_info_edit"],{"4bc0":function(t,e,i){"use strict";var a=i("6acd"),s=i.n(a);s.a},"6acd":function(t,e,i){},"95a2":function(t,e,i){"use strict";i.r(e);var a=i("c5d0"),s=i("9807");for(var o in s)"default"!==o&&function(t){i.d(e,t,function(){return s[t]})}(o);i("4bc0");var n=i("2877"),l=Object(n["a"])(s["default"],a["a"],a["b"],!1,null,"5c13d048",null);e["default"]=l.exports},9807:function(t,e,i){"use strict";i.r(e);var a=i("db7c"),s=i.n(a);for(var o in a)"default"!==o&&function(t){i.d(e,t,function(){return a[t]})}(o);e["default"]=s.a},c5d0:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",[i("view",[i("van-steps",{attrs:{steps:t.steps,active:t.active,mpcomid:"8d98611a-0"}})],1),i("view",{staticClass:"uni-padding-wrap uni-common-mt",staticStyle:{opacity:"0",height:"1rpx"}},[i("uni-segmented-control",{attrs:{current:t.current,values:t.items,styleType:t.styleType,activeColor:t.activeColor,eventid:"8d98611a-0",mpcomid:"8d98611a-1"},on:{clickItem:t.onClickItem}})],1),i("view",{staticClass:"content"},[i("view",{directives:[{name:"show",rawName:"v-show",value:0===t.current,expression:"current === 0"}]},[i("form",{attrs:{eventid:"8d98611a-7"},on:{submit:t.formSubmit,reset:t.formReset}},[i("view",{staticClass:"uni-list"},[i("view",{staticClass:"uni-list-cell"},[i("view",{staticClass:"uni-title",staticStyle:{color:"#777"}},[t._v("基本信息")])]),i("view",{staticClass:"uni-list-cell"},[t._v("店铺名称"),i("view",{staticClass:"uni-list-cell-right"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.text_info.store_name,expression:"text_info.store_name"}],staticClass:"uni-input",attrs:{name:"store_name",placeholder:"请输入",eventid:"8d98611a-1"},domProps:{value:t.text_info.store_name},on:{input:function(e){e.target.composing||(t.text_info.store_name=e.target.value)}}})])]),i("view",{staticClass:"uni-list-cell"},[t._v("联 系 人"),i("input",{directives:[{name:"model",rawName:"v-model",value:t.text_info.id_name,expression:"text_info.id_name"}],staticClass:"uni-input",attrs:{name:"name",placeholder:"请输入",eventid:"8d98611a-2"},domProps:{value:t.text_info.id_name},on:{input:function(e){e.target.composing||(t.text_info.id_name=e.target.value)}}})]),i("view",{staticClass:"uni-list-cell"},[t._v("联系电话"),i("input",{directives:[{name:"model",rawName:"v-model",value:t.text_info.store_tel,expression:"text_info.store_tel"}],staticClass:"uni-input",attrs:{name:"store_tel",placeholder:"请输入",eventid:"8d98611a-3"},domProps:{value:t.text_info.store_tel},on:{input:function(e){e.target.composing||(t.text_info.store_tel=e.target.value)}}})]),i("view",{staticClass:"uni-list-cell"},[t._v("所属行业"),i("view",{},[i("picker",{attrs:{value:t.cat_index,range:t.storeList,eventid:"8d98611a-4"},on:{change:t.catChange}},[i("view",{staticClass:"uni-input"},[t._v(t._s(t.storeList[t.cat_index]))])])],1)]),i("view",{staticClass:"uni-list-cell cell-pd"},[i("view",{staticClass:"uni-uploader"},[i("view",{staticClass:"uni-uploader-head"},[i("view",{staticClass:"uni-uploader-title"},[t._v("店铺logo")])]),i("view",{staticClass:"uni-uploader-body"},[i("view",{staticClass:"uni-uploader__files"},[i("block",[i("view",{staticClass:"uni-uploader__file"},[i("image",{staticClass:"uni-uploader__img",attrs:{mode:"aspectFill",src:t.text_info.avatar,"data-src":t.text_info.avatar,eventid:"8d98611a-5"},on:{tap:function(e){t.previewImagFn(t.text_info.avatar)}}})])]),i("view",{staticClass:"uni-uploader__input-box"},[i("view",{staticClass:"uni-uploader__input",attrs:{eventid:"8d98611a-6"},on:{tap:function(e){t.chooseImageFn(1)}}})])],1)])])])])])],1),i("view",{directives:[{name:"show",rawName:"v-show",value:1===t.current,expression:"current === 1"}]},[i("form",{attrs:{eventid:"8d98611a-9"},on:{submit:t.formSubmit,reset:t.formReset}},[i("view",{staticClass:"uni-list"},[i("view",{staticClass:"mapWrap"},[i("view",{staticClass:"infoWarp"},[i("view",{staticClass:"uni-title"},[t._v("店铺地址")]),i("view",{},[t._v(t._s(t.text_info.province_name)+t._s(t.text_info.city_name)+t._s(t.text_info.district_name)+t._s(t.text_info.address))])])]),i("view",{staticClass:"infoWarp"},[i("view",{staticClass:"uni-title"},[t._v("店铺介绍")]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text_info.info,expression:"text_info.info"}],staticStyle:{color:"#555",width:"auto"},attrs:{name:"info",placeholder:"请输入",eventid:"8d98611a-8"},domProps:{value:t.text_info.info},on:{input:function(e){e.target.composing||(t.text_info.info=e.target.value)}}})])])])],1),i("view",{directives:[{name:"show",rawName:"v-show",value:2===t.current,expression:"current === 2"}]},[i("form",{attrs:{eventid:"8d98611a-18"},on:{submit:t.formSubmit,reset:t.formReset}},[i("view",{staticClass:"uni-list"},[i("view",{staticClass:"uni-list-cell "},[i("view",{staticClass:"uni-title"},[t._v("证件上传")])]),i("view",{staticClass:"uni-list-cell cell-pd"},[i("view",{staticClass:"uni-uploader"},[i("view",{staticClass:"uni-uploader-head"},[i("view",{staticClass:"uni-uploader-title"},[t._v("招牌照片")])]),i("view",{staticClass:"uni-uploader-body"},[i("view",{staticClass:"uni-uploader__files"},[i("block",[i("view",{staticClass:"uni-uploader__file",staticStyle:{width:"60%"}},[i("image",{staticClass:"uni-uploader__img",attrs:{mode:"aspectFill",src:t.text_info.store_img,"data-src":t.text_info.store_img,eventid:"8d98611a-10"},on:{tap:function(e){t.previewImagFn(t.text_info.store_img)}}})])]),i("view",{staticClass:"uni-uploader__input-box"},[i("view",{staticClass:"uni-uploader__input",attrs:{eventid:"8d98611a-11"},on:{tap:function(e){t.chooseImageFn(2)}}})])],1)])])]),i("view",{staticClass:"uni-list-cell cell-pd"},[i("view",{staticClass:"uni-uploader"},[i("view",{staticClass:"uni-uploader-head"},[i("view",{staticClass:"uni-uploader-title"},[t._v("营业执照")])]),i("view",{staticClass:"uni-uploader-body"},[i("view",{staticClass:"uni-uploader__files"},[""!=t.text_info.store_img1?i("view",{staticClass:"uni-uploader__file"},[i("image",{staticClass:"uni-uploader__img",attrs:{mode:"aspectFill",src:t.text_info.store_img1,"data-src":t.text_info.store_img1,eventid:"8d98611a-12"},on:{tap:function(e){t.previewImagFn(t.text_info.store_img1)}}})]):t._e(),1!=t.text_info.status?i("view",{staticClass:"uni-uploader__input-box"},[i("view",{staticClass:"uni-uploader__input",attrs:{eventid:"8d98611a-13"},on:{tap:function(e){t.chooseImageFn(3)}}})]):t._e()])])])]),i("view",{staticClass:"uni-list-cell cell-pd"},[i("view",{staticClass:"uni-uploader"},[i("view",{staticClass:"uni-uploader-head"},[i("view",{staticClass:"uni-uploader-title"},[t._v("身份证正反面")])]),i("view",{staticClass:"uni-uploader-body"},[i("view",{staticClass:"uni-uploader__files"},[t._l(t.id_image_ist,function(e,a){return i("block",{key:a},[i("view",{staticClass:"uni-uploader__file"},[1==t.text_info.status?i("image",{staticClass:"uni-uploader__img",attrs:{mode:"aspectFill",src:e,"data-src":e,eventid:"8d98611a-14-"+a},on:{tap:function(i){t.previewImagFns(e,a,1)}}}):t._e(),1!=t.text_info.status?i("image",{staticClass:"uni-uploader__img",attrs:{mode:"aspectFill",src:e,"data-src":e,eventid:"8d98611a-15-"+a},on:{tap:function(i){t.previewImagFns(e,a)}}}):t._e()])])}),1!=t.text_info.status?i("view",{staticClass:"uni-uploader__input-box"},[i("view",{staticClass:"uni-uploader__input",attrs:{eventid:"8d98611a-16"},on:{tap:function(e){t.chooseImageFns(t.image)}}})]):t._e()],2)])])]),i("view",{staticClass:"uni-list-cell"},[t._v("身份证号"),i("view",{staticClass:"uni-list-cell-right"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.text_info.id_card,expression:"text_info.id_card"}],staticClass:"uni-input",attrs:{disabled:1==t.text_info.status,type:"idcard",name:"id_card",placeholder:"请输入",eventid:"8d98611a-17"},domProps:{value:t.text_info.id_card},on:{input:function(e){e.target.composing||(t.text_info.id_card=e.target.value)}}})])])])])],1)]),i("view",{staticClass:"uni-btn-v"},[2==t.active?i("button",{staticClass:"btn-submit",attrs:{type:"primary",eventid:"8d98611a-19"},on:{tap:t.formSubmit}},[t._v("确认修改")]):t._e(),2!=t.active?i("button",{staticClass:"btn-submit",attrs:{type:"primary",eventid:"8d98611a-20"},on:{tap:t.nextStepsFn}},[t._v("下一步")]):t._e(),0!=t.active?i("button",{attrs:{type:"default",eventid:"8d98611a-21"},on:{tap:t.preStepsFn}},[t._v("上一步")]):t._e()],1)])},s=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return s})},db7c:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(i("a34a")),s=o(i("7861"));function o(t){return t&&t.__esModule?t:{default:t}}function n(t,e,i,a,s,o,n){try{var l=t[o](n),c=l.value}catch(r){return void i(r)}l.done?e(c):Promise.resolve(c).then(a,s)}function l(t){return function(){var e=this,i=arguments;return new Promise(function(a,s){var o=t.apply(e,i);function l(t){n(o,a,s,l,c,"next",t)}function c(t){n(o,a,s,l,c,"throw",t)}l(void 0)})}}i("7389");var c={components:{uniSegmentedControl:s.default},data:function(){return{steps:[{text:"基本信息",desc:""},{text:"店铺介绍",desc:""},{text:"证件上传",desc:""}],active:0,current:0,items:["步骤 1","步骤 2","步骤 3"],storeListAll:[],storeList:[],cat_index:0,array:["餐饮美食","洗浴住宿","观影k哥"],array1:["正常营业","休息中","已关店"],array_index:0,activeColor:"#0faeff",styleType:"button",uploaddata:{},uploaddata_id:{},text_info:{},latitude:null,longitude:null,covers_markers:[],mapCtx:null,id_image_ist:[]}},onShow:function(){var t=this;console.log("---------store show===text_info",this.$store.state.shop_edit_info.length,JSON.stringify(this.$store.state.shop_edit_info)),t.text_info&&(console.log("store youhuo"),t.text_info=this.$store.state.shop_edit_info,void 0==t.text_info.profile_picture1&&void 0!=t.text_info.profile_picture2?(console.log("stroe---\x3e",0),t.id_image_ist=[t.text_info.profile_picture2]):void 0==t.text_info.profile_picture2&&void 0!=t.text_info.profile_picture1?(console.log("stroe---\x3e",1),t.id_image_ist=[t.text_info.profile_picture1]):void 0==t.text_info.profile_picture1&&void 0==t.text_info.profile_picture2?(console.log("stroe---\x3e","00"),t.id_image_ist=[]):(console.log("stroe---\x3e",2),t.id_image_ist=[t.text_info.profile_picture1,t.text_info.profile_picture2]))},onLoad:function(t){this.getData(),this.getOssParam(),this.getOssParamId(),this.imageList=[],this.getLocation()},methods:{getData:function(){var e=this;this.$util.ajax_uni({url:"merchants/index/show",data:{ff_openid:t.getStorageSync("user_id")},success:function(i){console.log("返回店铺信息res:",i),1==i.data.status?(e.text_info=i.data.data.data,e.getStore(),console.log("---------store onload===text_info",JSON.stringify(e.text_info)),void 0==e.text_info.profile_picture1?(console.log(0),e.id_image_ist=[e.text_info.profile_picture2]):void 0==e.text_info.profile_picture2?(console.log(1),e.id_image_ist=[e.text_info.profile_picture1]):(console.log(2),e.id_image_ist=[e.text_info.profile_picture1,e.text_info.profile_picture2]),console.log("id_image_ist===========",JSON.stringify(e.id_image_ist))):(console.log("ceeee",JSON.stringify(i.data)),t.showToast({icon:"none",title:i.data.msg}))},error:function(t){console.log("错误res:",t)}})},getStore:function(){var e=this;this.$util.ajax_uni({url:"merchants/index/cat",data:{},success:function(i){if(1==i.data.status)for(var a in e.storeListAll=i.data.data,i.data.data)i.data.data[a].value=i.data.data[a].id,e.storeList.push(i.data.data[a].name),i.data.data[a].id==e.text_info.cat_id&&(e.cat_index=a);else console.log("ceeee",JSON.stringify(i.data)),t.showToast({icon:"none",title:i.data.msg})},error:function(t){console.log("错误res:",t)}})},nextStepsFn:function(){console.log("active--",this.active,"current===",this.current),this.active<2&&(this.active+=1,this.current+=1)},preStepsFn:function(){console.log("active--",this.active,"current===",this.current),this.active>0&&(this.active-=1,this.current-=1)},bindPickerChange1:function(t){console.log("picker发送选择改变，携带值为",t.target.value),this.text_info.store_status=t.target.value},catChange:function(t){console.log("picker发送选择改变，携带值为",t.target.value),this.cat_index=t.target.value,this.text_info.cat_id=this.storeListAll[t.target.value].id},onClickItem:function(t){this.current!==t&&(this.current=t)},previewImagFn:function(e,i){t.previewImage({urls:[e]})},previewImagFns:function(e,i,a){console.log("chooseImageFns----",e),1==a?t.previewImage({current:this.id_image_ist[i],urls:this.id_image_ist}):(this.$store.commit("changeShopEditInfo",this.text_info),t.navigateTo({url:"./shop_img_detail?data="+e+"&&flag="+i}))},chooseImageFn:function(){var e=l(a.default.mark(function e(i){var s;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:s=this,e.t0=i,e.next=1===e.t0?4:2===e.t0?6:3===e.t0?8:4===e.t0?10:11;break;case 4:return t.chooseImage({count:1,success:function(e){var i=e.tempFilePaths;console.log("res?-=======",JSON.stringify(e));var a=s.uploaddata.dir+Date.parse(new Date)+"_"+s.randomString(6)+"."+i[0].split(".").pop();t.uploadFile({url:"https://ffomall.oss-cn-hangzhou.aliyuncs.com",filePath:i[0],name:"file",formData:{key:a,policy:s.uploaddata.policy,OSSAccessKeyId:s.uploaddata.OSSAccessKeyId,callback:s.uploaddata.callback,signature:s.uploaddata.signature,success_action_status:"203"},success:function(t){console.log("uploadImage success, res is:",t.data),s.text_info.avatar="https://ffomall.oss-cn-hangzhou.aliyuncs.com/"+JSON.parse(t.data).filename},fail:function(e){console.log("uploadImage fail",JSON.stringify(e)),t.showModal({content:e.errMsg,showCancel:!1}),t.hideLoading()},complete:function(){console.log("complate")}})}}),e.abrupt("break",12);case 6:return t.chooseImage({count:1,success:function(e){var i=e.tempFilePaths;console.log("res?-=======",JSON.stringify(e));var a=s.uploaddata.dir+Date.parse(new Date)+"_"+s.randomString(6)+"."+i[0].split(".").pop();t.uploadFile({url:"https://ffomall.oss-cn-hangzhou.aliyuncs.com",filePath:i[0],name:"file",formData:{key:a,policy:s.uploaddata.policy,OSSAccessKeyId:s.uploaddata.OSSAccessKeyId,callback:s.uploaddata.callback,signature:s.uploaddata.signature,success_action_status:"203"},success:function(t){console.log("uploadImage success, res is:",t.data),s.text_info.store_img="https://ffomall.oss-cn-hangzhou.aliyuncs.com/"+JSON.parse(t.data).filename},fail:function(e){console.log("uploadImage fail",JSON.stringify(e)),t.showModal({content:e.errMsg,showCancel:!1}),t.hideLoading()},complete:function(){console.log("complate")}})}}),e.abrupt("break",12);case 8:return t.chooseImage({count:1,success:function(e){var i=e.tempFilePaths;console.log("res?-=======",JSON.stringify(e));var a=s.uploaddata.dir+Date.parse(new Date)+"_"+s.randomString(6)+"."+i[0].split(".").pop();t.uploadFile({url:"https://ffomall.oss-cn-hangzhou.aliyuncs.com",filePath:i[0],name:"file",formData:{key:a,policy:s.uploaddata.policy,OSSAccessKeyId:s.uploaddata.OSSAccessKeyId,callback:s.uploaddata.callback,signature:s.uploaddata.signature,success_action_status:"203"},success:function(t){console.log("uploadImage success------, res is:",t.data),s.text_info.store_img1="https://ffomall.oss-cn-hangzhou.aliyuncs.com/"+JSON.parse(t.data).filename,console.log("--修改",JSON.stringify(s.text_info))},fail:function(e){console.log("uploadImage fail",JSON.stringify(e)),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){console.log("complate")}})}}),e.abrupt("break",12);case 10:return e.abrupt("break",12);case 11:return e.abrupt("break",12);case 12:case"end":return e.stop()}},e,this)}));function i(t){return e.apply(this,arguments)}return i}(),chooseImageFns:function(e){var i=this;console.log("chooseImage--Fns----",e),2!=i.id_image_ist.length?t.chooseImage({count:2,success:function(e){var a=e.tempFilePaths;for(var s in console.log("res?-=======",JSON.stringify(e)),a){var o=i.uploaddata_id.dir+Date.parse(new Date)+"_"+i.randomString(6)+"."+a[s].split(".").pop();t.uploadFile({url:"https://ffomallcardid.oss-cn-hangzhou.aliyuncs.com",filePath:a[s],name:"file",formData:{key:o,policy:i.uploaddata_id.policy,OSSAccessKeyId:i.uploaddata_id.OSSAccessKeyId,callback:i.uploaddata_id.callback,signature:i.uploaddata_id.signature,success_action_status:"203"},success:function(t){i.id_image_ist.push("https://ffomallcardid.oss-cn-hangzhou.aliyuncs.com/"+JSON.parse(t.data).filename),console.log("uploadImage =====jiddddddd=:",JSON.stringify(i.id_image_ist))},fail:function(e){console.log("uploadImage fail",JSON.stringify(e)),t.showModal({content:e.errMsg,showCancel:!1}),t.hideLoading()},complete:function(){console.log("complate")}})}}}):t.showToast({title:"请先删除照片",icon:"none"})},randomString:function(t,e){e=e||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var i="",a=0;a<t;a++){var s=Math.floor(Math.random()*e.length);i+=e.substring(s,s+1)}return i},getOssParam:function(){var e=this;t.request({url:this.base_url+"notify/alioss/getsign",method:"post",data:{sign:"3521257fc593c5d202474f6ac0c245ae"},success:function(t){console.log("res?-",t),1==t.data.status&&(e.uploaddata=t.data.data)},fail:function(){},complete:function(){}})},getOssParamId:function(){var e=this;t.request({url:this.base_url+"merchants/index/upload",method:"post",data:{token:t.getStorageSync("token")},success:function(t){console.log("res?========-",t),1==t.data.status&&(e.uploaddata_id=t.data.data)},fail:function(){},complete:function(){}})},formReset:function(t){console.log("清空数据"),this.chosen=""},previewImageFn:function(e){t.previewImage({urls:[e]})},choseLocation:function(){var e=this;console.log("位置名称：--------"),t.chooseLocation({success:function(t){console.log("位置名称："+t.name),console.log("详细地址："+t.address),console.log("纬度："+t.latitude),console.log("经度："+t.longitude),e.longitude=t.longitude,e.latitude=t.latitude,e.covers_markers.pop(),e.covers_markers.push({latitude:t.latitude,longitude:t.longitude,label:{content:t.name}})}})},getLocation:function(){var e=this;t.getLocation({type:"gcj02",success:function(t){console.log("当前位置的纬度："+t.latitude),e.longitude=t.longitude,e.latitude=t.latitude,e.covers_markers.push({latitude:t.latitude,longitude:t.longitude})},fail:function(t){console.log("res-fail",t)}})},formSubmit:function(e){var i="";i=1==this.text_info.status?"merchants/index/updateRegistered":"merchants/index/updateReg",this.text_info.profile_picture1=this.id_image_ist[0],this.text_info.profile_picture2=this.id_image_ist[1],console.log("入参---修改",JSON.stringify(this.text_info)),this.$util.ajax_uni({url:i,data:this.text_info,success:function(e){console.log("修改--返回---es:",e),1==e.data.status?t.navigateBack({url:"./shop_info"}):(console.log("ceeee",JSON.stringify(e.data)),t.showToast({icon:"none",title:e.data.msg}))},error:function(t){console.log("错误res:",t)}})}}};e.default=c}).call(this,i("649d")["default"])},de51:function(t,e,i){"use strict";i("7297");var a=o(i("b0ce")),s=o(i("95a2"));function o(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(s.default))}},[["de51","common/runtime","common/vendor"]]]);